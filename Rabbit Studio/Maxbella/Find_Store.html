<div class="locator-widget">
  <div class="locator-container">
    <div class="locator-sidebar">
      <div class="locator-search-box">
        <div class="locator-search-group">
          <input type="text" id="locatorPostalCodeInput" placeholder="Type a postcode or address.."
            aria-label="Postal code" />
          <!-- Botón-ícono integrado (sin fondo) -->
          <button id="locatorSearchButton" aria-label="Search" class="search-inline-btn">
            <img
              src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%20width%3D%2218%22%20height%3D%2218%22%20fill%3D%22%232D1A0E%22%3E%3Cpath%20d%3D%22M508.5%20468.9L387.1%20347.5c-2.3-2.3-5.3-3.5-8.5-3.5h-13.2c31.5-36.5%2050.6-84%2050.6-136C416%2093.1%20322.9%200%20208%200S0%2093.1%200%20208s93.1%20208%20208%20208c52%200%2099.5-19.1%20136-50.6v13.2c0%203.2%201.3%206.2%203.5%208.5l121.4%20121.4c4.7%204.7%2012.3%204.7%2017%200l22.6-22.6c4.7-4.7%204.7-12.3%200-17zM208%20368c-88.4%200-160-71.6-160-160S119.6%2048%20208%2048s160%2071.6%20160%20160-71.6%20160-160%20160z%22/%3E%3C/svg%3E"
              alt="" width="18" height="18" aria-hidden="true" />
          </button>
        </div>
      </div>

      <div class="locator-map-container mobile-only">
        <div id="locatorMapMobile"></div>
      </div>

      <div class="locator-location-list">
        <!-- Ícono de CASITA con fondo redondo -->
        <div class="locator-location-item">
          <span class="loc-icon" aria-hidden="true">
            <div class="icon-circle">
              <img
                src="https://cdn.shopify.com/s/files/1/0941/1457/8711/files/Store_icon_37b4ce06-e155-41ee-ae29-2b5a6c9b8e04.png?v=1758762478"
                alt="" width="24" height="24" />
            </div>
          </span>
          <div class="loc-text"><strong>Waves Market</strong><br>26006 North Carolina 12, Waves, NC 27982</div>
        </div>

        <div class="locator-location-item">
          <span class="loc-icon" aria-hidden="true">
            <div class="icon-circle">
              <img
                src="https://cdn.shopify.com/s/files/1/0941/1457/8711/files/Store_icon_37b4ce06-e155-41ee-ae29-2b5a6c9b8e04.png?v=1758762478"
                alt="" width="24" height="24" />
            </div>
          </span>
          <div class="loc-text"><strong>Zillie's Island Pantry</strong><br>538 Back Road #1688, Ocracoke, NC 27960</div>
        </div>

        <div class="locator-location-item">
          <span class="loc-icon" aria-hidden="true">
            <div class="icon-circle">
              <img
                src="https://cdn.shopify.com/s/files/1/0941/1457/8711/files/Store_icon_37b4ce06-e155-41ee-ae29-2b5a6c9b8e04.png?v=1758762478"
                alt="" width="24" height="24" />
            </div>
          </span>
          <div class="loc-text"><strong>The Fresh Market Nags Head</strong><br>5000 S. Croatan Hwy, Nags Head, NC 27959
          </div>
        </div>

        <div class="locator-location-item">
          <span class="loc-icon" aria-hidden="true">
            <div class="icon-circle">
              <img
                src="https://cdn.shopify.com/s/files/1/0941/1457/8711/files/Store_icon_37b4ce06-e155-41ee-ae29-2b5a6c9b8e04.png?v=1758762478"
                alt="" width="24" height="24" />
            </div>
          </span>
          <div class="loc-text"><strong>Harris Teeter</strong><br>2012 S Croatan Hwy, Kill Devil Hills, NC 27948</div>
        </div>
      </div>
    </div>

    <div class="locator-map-container desktop-only">
      <div id="locatorMap"></div>
    </div>
  </div>
</div>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  .leaflet-control-attribution {
    display: none;
  }

  .locator-header {
    margin-bottom: 20px;
    text-align: left;
  }

  .locator-title {
    margin: 0;
    font-size: 24px;
    font-weight: bold;
    color: #2D1A0E;
    font-family: "Satoshi Black", sans-serif;
  }

  .locator-subtitle {
    margin: 5px 0 0;
    font-size: 16px;
    color: #5c4635;
    font-family: "Satoshi Bold", sans-serif;
    padding-top: 50px;
    padding-bottom: 20px;
  }

  .leaflet-pane,
  #locatorMap,
  #locatorMapMobile {
    z-index: 1 !important;
  }

  .locator-widget {
    font-family: Arial, sans-serif;
    background: #FFF2DE;
    color: #2D1A0E;
  }

  .locator-container {
    display: flex;
    flex-wrap: wrap;
  }

  .locator-sidebar {
    flex: 1 1 300px;
    padding: 5px 20px 20px 20px;
    box-sizing: border-box;
  }

  .locator-search-box {
    padding-bottom: 40px;
  }

  .locator-search-group {
    position: relative;
    display: block;
    max-width: 640px;
  }

  .locator-search-group input {
    width: 100%;
    padding: 12px 48px 12px 16px;
    font-size: 16px;
    background: #fff;
    color: #4a4a4a;
    border: 1px solid #ccc;
    border-radius: 9999px;
    box-sizing: border-box;
    outline: none;
    transition: box-shadow .2s, border-color .2s;
    box-shadow: 0 6px 0 #000;
    font-family: 'Open Sans', sans-serif;
  }

  .locator-search-group input:focus {
    border-color: #2D1A0E;
  }

  .search-inline-btn {
    position: absolute;
    top: 50%;
    right: 12px;
    transform: translateY(-50%);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
  }

  .search-inline-btn img {
    display: block
  }

  .locator-location-list {
    margin-top: 20px;
  }

  .locator-location-item {
    display: flex;
    gap: 12px;
    align-items: center;
    margin-bottom: 18px;
    font-size: 14px;
    line-height: 1.5;
  }

  .loc-icon {
    flex: 0 0 auto;
    display: inline-flex;
    align-items: center;
  }

  .icon-circle {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #7f3a20;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .loc-text {
    flex: 1 1 auto;
    font-family: 'Open Sans', sans-serif;
  }

  .locator-map-container {
    flex: 2 1 500px;
    height: 500px;
  }

  #locatorMap,
  #locatorMapMobile {
    width: 100%;
    height: 100%;
    border-radius: 16px;
    overflow: hidden;
  }

  .mobile-only {
    display: none;
  }

  .desktop-only {
    display: block;
  }

  @media (max-width:768px) {
    .locator-container {
      flex-direction: column;
    }

    .locator-sidebar {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .locator-search-box {
      order: 1;
      margin-bottom: 12px;
      padding-bottom: 12px;
    }

    .locator-location-list {
      order: 2;
      margin-top: 10px;
    }

    .locator-map-container {
      height: 300px;
    }

    .locator-map-container.mobile-only {
      order: 3;
      margin-top: 16px;
    }

    .mobile-only {
      display: block;
    }

    .desktop-only {
      display: none;
    }
  }

  @media (min-width:769px) {
    .locator-container {
      max-width: 1250px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      padding: 0 20px;
    }
  }
</style>

<script>
  const locatorMapDesktop = L.map('locatorMap').setView([35.5, -75.7], 8);
  const locatorMapMobile = L.map('locatorMapMobile').setView([35.5, -75.7], 8);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
  }).addTo(locatorMapDesktop);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
  }).addTo(locatorMapMobile);

  const locations = [
    { name: "Waves Market", coords: [35.5678, -75.4668] },
    { name: "Zillie's Island Pantry", coords: [35.1144, -75.9811] },
    { name: "The Fresh Market Nags Head", coords: [35.9658, -75.6320] },
    { name: "Harris Teeter", coords: [35.9932, -75.6451] }
  ];

  locations.forEach(loc => {
    L.marker(loc.coords).addTo(locatorMapDesktop).bindPopup(loc.name);
    L.marker(loc.coords).addTo(locatorMapMobile).bindPopup(loc.name);
  });

  const input = document.getElementById("locatorPostalCodeInput");
  const btn = document.getElementById("locatorSearchButton");

  function doSearch() {
    const q = input.value.trim();
    if (!q) return;
    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}`)
      .then(res => res.json())
      .then(data => {
        if (!data.length) return;
        const { lat, lon } = data[0];
        const coords = [parseFloat(lat), parseFloat(lon)];
        [locatorMapDesktop, locatorMapMobile].forEach(map => map.setView(coords, 13));
      })
      .catch(console.error);
  }

  btn.addEventListener("click", doSearch);
  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") doSearch();
  });
</script>